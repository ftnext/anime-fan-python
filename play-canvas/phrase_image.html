<!DOCTYPE html>

<head>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@900&display=swap"
    rel="stylesheet"
  />
</head>

<body>
  <input id="sentenceInput1" />
  <input id="sentenceInput2" />
  <button id="drawCanvas">Draw</button>
  <canvas id="canvas"></canvas>

  <script>
    const sentenceInput1 = document.getElementById("sentenceInput1");
    const sentenceInput2 = document.getElementById("sentenceInput2");
    const drawButton = document.getElementById("drawCanvas");

    drawButton.onclick = () => {
      const sentence1 = sentenceInput1.value;
      const sentence2 = sentenceInput2.value;
      const sentences = [sentence1, sentence2];

      clearCanvas();
      drawTextOnCanvas(sentences);
    };

    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = 1280;
    canvas.height = 720;

    function clearCanvas() {
      ctx.fillStyle = "yellow";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    function calculateFontSize(sentenceLength) {
      return (canvas.width - 60) / (sentenceLength + 0.5);
    }

    function generateFontCss(fontSize) {
      return `bold ${fontSize}px 'Noto Sans JP'`;
    }

    function calculateXCenterStart(sentence) {
      const textWidth = ctx.measureText(sentence).width;
      return (canvas.width - textWidth) / 2;
    }

    function calculateYCenterStart(fontSize, linesCount, lineIndex) {
      const lineHeight = canvas.height / linesCount;
      const yCenterInOneLine = (lineHeight + fontSize) / 2;
      return lineHeight * (lineIndex - 1) + yCenterInOneLine;
    }

    function calculateCenteringStart(
      sentence,
      fontSize,
      linesCount,
      lineIndex
    ) {
      const xStart = calculateXCenterStart(sentence);
      const yStart = calculateYCenterStart(fontSize, linesCount, lineIndex);
      return { x: xStart, y: yStart };
    }

    function drawTextOnCanvas(sentences) {
      const notEmptySentences = sentences.filter((s) => s !== "");
      const linesCount = notEmptySentences.length;
      ctx.fillStyle = "aqua";
      for (let i = 0; i < linesCount; i++) {
        let sentence = notEmptySentences[i];
        const fontSize = calculateFontSize(sentence.length);
        ctx.font = generateFontCss(fontSize);
        point = calculateCenteringStart(sentence, fontSize, linesCount, i + 1);
        ctx.fillText(sentence, point.x, point.y);
      }
    }
  </script>
</body>
