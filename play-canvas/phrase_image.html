<!DOCTYPE html>

<head>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@900&display=swap"
    rel="stylesheet"
  />
</head>

<body>
  <input id="sentenceInput" />
  <button id="drawCanvas">Draw</button>
  <canvas id="canvas"></canvas>

  <script>
    const sentenceInput = document.getElementById("sentenceInput");
    const drawButton = document.getElementById("drawCanvas");

    drawButton.onclick = () => {
      const sentence = sentenceInput.value;
      drawTextOnCanvas(sentence);
    };

    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = 1280;
    canvas.height = 720;

    function clearCanvas() {
      ctx.fillStyle = "yellow";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    function calculateFontSize(sentenceLength) {
      return (canvas.width - 60) / (sentenceLength + 0.5);
    }

    function generateFontCss(fontSize) {
      return `bold ${fontSize}px 'Noto Sans JP'`;
    }

    function calculateCenteringStart(sentence, fontSize, lineCount) {
      const textWidth = ctx.measureText(sentence).width;
      const xStart = (canvas.width - textWidth) / 2;
      const yStart = (canvas.height / lineCount + fontSize) / 2;
      return { x: xStart, y: yStart };
    }

    function drawTextOnCanvas(sentence) {
      clearCanvas();

      ctx.fillStyle = "aqua";
      const fontSize = calculateFontSize(sentence.length);
      ctx.font = generateFontCss(fontSize);
      point = calculateCenteringStart(sentence, fontSize, 1);
      ctx.fillText(sentence, point.x, point.y);
    }
  </script>
</body>
